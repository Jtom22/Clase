\chapter{\texorpdfstring{$<$}{<}a href="{}https\+://github.\+com/azogue/esiosdata/blob/master/\+README.\+md\#esiosdata"{} \texorpdfstring{$>$}{>}\texorpdfstring{$<$}{<}strong\texorpdfstring{$>$}{>}Esios\+Data\texorpdfstring{$<$}{<}/strong\texorpdfstring{$>$}{>}\texorpdfstring{$<$}{<}/a\texorpdfstring{$>$}{>}}
\hypertarget{md__ej2_markdown}{}\label{md__ej2_markdown}\index{$<$a href="{}https://github.com/azogue/esiosdata/blob/master/README.md\#esiosdata"{} $>$$<$strong$>$EsiosData$<$/strong$>$$<$/a$>$@{$<$a href=""https://github.com/azogue/esiosdata/blob/master/README.md\#esiosdata"" $>$$<$strong$>$EsiosData$<$/strong$>$$<$/a$>$}}
\label{md__ej2_markdown_autotoc_md1}%
\Hypertarget{md__ej2_markdown_autotoc_md1}%
\DoxyHorRuler{0}


\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\+Web scraper\texorpdfstring{$\ast$}{*} para datos de demanda, producción y coste de la energía eléctrica en España, y simulador de facturación eléctrica según el PVPC.\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}

Para utilizarlo necesitas obtener un {\ttfamily token} para la autentificación en la API de la web \href{https://www.esios.ree.es/es}{\texttt{ ESIOS de REE}}.

Envía un correo electrónico a \href{consultasios@ree.es}{\texttt{ consultasios@ree.\+es}} solicitando un código de acceso personal. Recibirás un código {\ttfamily (token)}, grábalo en disco en tu {\ttfamily /home/user} como un archivo oculto de nombre .token\+\_\+api\+\_\+esios. En línea de comandos, ejecuta el siguiente comando substituyendo las X\textquotesingle{}s por tu código personal\+:

\texorpdfstring{$>$}{>}echo "{}\+XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"{} \texorpdfstring{$>$}{>} \texorpdfstring{$\sim$}{\string~}/.\texorpdfstring{$>$}{>}token\+\_\+api\+\_\+esios\hypertarget{md__ej2_markdown_autotoc_md2}{}\doxysection{\texorpdfstring{$<$a href="{}https\+://github.\+com/azogue/esiosdata/blob/master/\+README.\+md\#instalaci\%\+C3\%\+B3n"{} $>$$<$strong$>$\+Instalación$<$/strong$>$$<$/a$>$}{<a href="https://github.com/azogue/esiosdata/blob/master/README.md\#instalaci\%C3\%B3n" ><strong>Instalación</strong></a>}}\label{md__ej2_markdown_autotoc_md2}
\DoxyHorRuler{0}
 \texorpdfstring{$>$}{>}pip3 install esiosdata\hypertarget{md__ej2_markdown_autotoc_md3}{}\doxysection{\texorpdfstring{$<$a href="{}https\+://github.\+com/azogue/esiosdata/blob/master/\+README.\+md\#uso-\/de-\/la-\/librer\%\+C3\%\+ADa"{} $>$$<$strong$>$\+Uso de la librería$<$/strong$>$$<$/a$>$}{<a href="https://github.com/azogue/esiosdata/blob/master/README.md\#uso-de-la-librer\%C3\%ADa" ><strong>Uso de la librería</strong></a>}}\label{md__ej2_markdown_autotoc_md3}
\DoxyHorRuler{0}
 \hypertarget{md__ej2_markdown_autotoc_md4}{}\doxysubsection{\texorpdfstring{$<$a href="{}https\+://github.\+com/azogue/esiosdata/blob/master/\+README.\+md\#-\/l\%\+C3\%\+ADnea-\/de-\/comandos"{} $>$$<$strong$>$· Línea de comandos\+:$<$/strong$>$$<$/a$>$}{<a href="https://github.com/azogue/esiosdata/blob/master/README.md\#-l\%C3\%ADnea-de-comandos" ><strong>· Línea de comandos:</strong></a>}}\label{md__ej2_markdown_autotoc_md4}
\texorpdfstring{$>$}{>}python esiosdata -\/h \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} usage\+: esiosdata \mbox{[}-\/h\mbox{]} \mbox{[}-\/v\mbox{]} \mbox{[}-\/d\mbox{]} \mbox{[}-\/fu\mbox{]} \mbox{[}-\/u\mbox{]} \mbox{[}-\/p\mbox{]} \mbox{[}-\/i \mbox{[}INFO \mbox{[}INFO ...\mbox{]}\mbox{]}\mbox{]} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Gestor de DB de PVPC/\+DEMANDA (esios.\+ree.\+es) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} optional arguments\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/h, --help show this help message and exit \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/v, --verbose Shows extra info \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/d, --dem Select REE data \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/fu, -\/FU, --forceupdate \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Force update of all available data \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/u, -\/U, --update Updates data until today \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/p, --plot Plots info of DB \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/i \mbox{[}INFO \mbox{[}INFO ...\mbox{]}\mbox{]}, --info \mbox{[}INFO \mbox{[}INFO ...\mbox{]}\mbox{]} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Shows info of DB \begin{quote}
 \end{quote}
\#\#\# · \href{https://github.com/azogue/esiosdata/blob/master/README.md\#-python}{\texttt{ {\bfseries{Python}}}}\+: \hypertarget{md__ej2_markdown_autotoc_md5}{}\doxyparagraph{\texorpdfstring{$<$a href="{}https\+://github.\+com/azogue/esiosdata/blob/master/\+README.\+md\#-\/-\/datos-\/de-\/pvpc"{} $>$$<$strong$>$-\/ Datos de PVPC\+:$<$/strong$>$$<$/a$>$}{<a href="https://github.com/azogue/esiosdata/blob/master/README.md\#--datos-de-pvpc" ><strong>- Datos de PVPC:</strong></a>}}\label{md__ej2_markdown_autotoc_md5}
\texorpdfstring{$>$}{>}from esiosdata import PVPC pvpc\+\_\+handler = PVPC() print(\textquotesingle{}Códigos de tarifas\+: \{\}\textquotesingle{}.format(pvpc\+\_\+handler.\+tarifas)) ts\+\_\+last, nrows\+\_\+tot = pvpc\+\_\+handler.\+last\+\_\+entry() print(\textquotesingle{}TS LAST VALUE\+: \{\}; TOTAL VALUES\+: \{\}\textquotesingle{}.format(ts\+\_\+last, nrows\+\_\+tot)) from esiosdata.\+facturapvpc import (Factura\+Elec, ROUND\+\_\+\+PREC, TIPO\+\_\+\+PEAJE\+\_\+\+GEN, TIPO\+\_\+\+PEAJE\+\_\+\+NOC,TIPO\+\_\+\+PEAJE\+\_\+\+VHC, ZONA\+\_\+\+IMPUESTOS\+\_\+\+CANARIAS, ZONA\+\_\+\+IMPUESTOS\+\_\+\+PENIN\+\_\+\+BALEARES, ZONA\+\_\+\+IMPUESTOS\+\_\+\+CEUTA\+\_\+\+MELILLA) \# Salida\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} BASE DE DATOS LOCAL HDF\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Nº entradas\+: 24913 mediciones \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Última\+: 01-\/02-\/2017 23\+:00 \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} LA INFORMACIÓN ESTÁ ACTUALIZADA (delta = -\/34321.\+0 segs) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Códigos de tarifas\+: \mbox{[}\textquotesingle{}GEN\textquotesingle{}, \textquotesingle{}NOC\textquotesingle{}, \textquotesingle{}VHC\textquotesingle{}\mbox{]} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} TS LAST VALUE\+: 2017-\/02-\/01 23\+:00\+:00+01\+:00; TOTAL VALUES\+: 24913 Más detalles en el notebook asociado\+: \href{https://github.com/azogue/esiosdata/blob/master/notebooks/esiosdata\%20-\%20PVPC\%20data.ipynb}{\texttt{ "{}esiosdata -\/ PVPC data"{}}} \begin{quote}
 \end{quote}
\#\#\#\#\# \href{https://github.com/azogue/esiosdata/blob/master/README.md\#--facturaci\%C3\%B3n-del-consumo-el\%C3\%A9ctrico}{\texttt{ {\bfseries{-\/ Facturación del consumo eléctrico\+:}}}} Este paquete incorpora una {\bfseries{calculadora de la factura eléctrica}} en base a la legislación española sobre el {\bfseries{PVPC}} ({\itshape Precio voluntario para el pequeño consumidor}). Facilita el cálculo del coste de la electricidad para las distintas discriminaciones horarias disponibles, tanto para lecturas de consumo totales (contadores antiguos) como para los nuevos contadores de registro horario.

La clase {\ttfamily Factura\+Elec} proporciona un objeto con el desglose detallado de cada periodo facturado, además de producir representaciones de dicho desglose en texto plano y HTML.

\texorpdfstring{$>$}{>}from esiosdata import Factura\+Elec t\+\_\+0, t\+\_\+f = \textquotesingle{}2016-\/11-\/01\textquotesingle{}, \textquotesingle{}2016-\/12-\/31\textquotesingle{} factura = Factura\+Elec(t\+\_\+0, t\+\_\+f, tipo\+\_\+peaje=\textquotesingle{}VHC\textquotesingle{}, consumo=\mbox{[}219, 126, 154\mbox{]}) html\+\_\+factura = factura.\+to\+\_\+html() print(factura) \# representación en texto plano \begin{quote}
 \end{quote}
\texorpdfstring{$>$}{>}\# Salida\+: \begin{quote}
 \end{quote}
\texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} FACTURA ELÉ\+CTRICA\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/--- \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Fecha inicio 01/11/2016 \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Fecha final 31/12/2016 \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Peaje de acceso 2.\+0\+DHS (Vehículo eléctrico) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Potencia contratada 3.\+45 kW \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Consumo periodo 499.\+00 k\+Wh \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} ¿\+Bono Social? No \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Equipo de medida 1.\+59 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Impuestos Península y Baleares (IVA) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$\ast$}{*} Días facturables 60 \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/--- \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ CÁ\+LCULO DEL TÉ\+RMINO FIJO POR POTENCIA CONTRATADA\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} 3.\+45 kW \texorpdfstring{$\ast$}{*} 42.\+043426 €/k\+W/año \texorpdfstring{$\ast$}{*} 60 días (2016) / 366 = 23.\+78 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/\texorpdfstring{$>$}{>} Término fijo 23.\+78 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ CÁ\+LCULO DEL TÉ\+RMINO VARIABLE POR ENERGÍA CONSUMIDA (TARIFA 2.\+0\+DHS)\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Periodo 1\+: 0.\+151329 €/k\+Wh -\/\texorpdfstring{$>$}{>} 33.\+14€(\+P1) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ Peaje de acceso\+: 219k\+Wh \texorpdfstring{$\ast$}{*} 0.\+062012€/k\+Wh = 13.\+58€ \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ Coste de la energía\+: 219k\+Wh \texorpdfstring{$\ast$}{*} 0.\+089317€/k\+Wh = 19.\+56€ \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Periodo 2\+: 0.\+080943 €/k\+Wh -\/\texorpdfstring{$>$}{>} 10.\+20€(\+P2) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ Peaje de acceso\+: 126k\+Wh \texorpdfstring{$\ast$}{*} 0.\+002879€/k\+Wh = 0.\+36€ \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ Coste de la energía\+: 126k\+Wh \texorpdfstring{$\ast$}{*} 0.\+078064€/k\+Wh = 9.\+84€ \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} Periodo 3\+: 0.\+062982 €/k\+Wh -\/\texorpdfstring{$>$}{>} 9.\+70€(\+P3) \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ Peaje de acceso\+: 154k\+Wh \texorpdfstring{$\ast$}{*} 0.\+000886€/k\+Wh = 0.\+14€ \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ Coste de la energía\+: 154k\+Wh \texorpdfstring{$\ast$}{*} 0.\+062096€/k\+Wh = 9.\+56€ \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/\texorpdfstring{$>$}{>} Término de consumo 53.\+04 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ IMPUESTO ELÉ\+CTRICO\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} 5.\+11269632\% x (23.\+78€ + 53.\+04€) 3.\+93 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ EQUIPO DE MEDIDA\+: 1.\+59 €\textbackslash{} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} -\/ IVA O EQUIVALENTE\+: \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} 21\% de 82.\+34€ 17.\+29 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \# TOTAL FACTURA 99.\+63 € \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# \begin{quote}
 \end{quote}
Más detalles en el notebook asociado\+: \href{https://github.com/azogue/esiosdata/blob/master/notebooks/esiosdata\%20-\%20Facturaci\%C3\%B3n.ipynb}{\texttt{ "{}esiosdata -\/ Facturación"{}}}\hypertarget{md__ej2_markdown_autotoc_md6}{}\doxysection{\texorpdfstring{$<$a href="{}https\+://github.\+com/azogue/esiosdata/blob/master/\+README.\+md\#tests"{} $>$$<$strong$>$\+Tests$<$/strong$>$$<$/a$>$}{<a href="https://github.com/azogue/esiosdata/blob/master/README.md\#tests" ><strong>Tests</strong></a>}}\label{md__ej2_markdown_autotoc_md6}
\DoxyHorRuler{0}
 Este paquete está testado con una cobertura completa (100\% code coverage), y no se le han detectado errores, lo cual no es garantía de que no los haya. Si descubres alguno, que no esté relacionado con la respuesta de los servidores de ESIOS (que fallan a menudo y son algo perezosos, todo sea dicho), puedes descargar el paquete completo y ejecutar los tests, así como corregir el error!

\texorpdfstring{$>$}{>}py.\+test --cov=esiosdata -\/v --cov-\/report html 